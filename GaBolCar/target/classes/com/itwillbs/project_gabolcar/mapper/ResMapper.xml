<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.project_gabolcar.mapper.ResMapper">
	<insert id="insertResInfo">
		INSERT INTO res_info
		VALUES
		(
			null
			,#{res_time}
			,#{res_rental_date}
			,#{res_return_date}
			,#{brc_rent_name}
			,#{brc_return_name}
			,#{car_idx}
			,#{car_insurance}
			,#{lic_num}
			,#{mem_idx}
		)
	</insert>
	
	<!-- 차량 인기순위 뽑기 -->
	<!-- 유의사항 !
		인기순위를 뽑아 order by 절에 사용할때
		컬럼 LIKE "기준값" 을 사용하는데
		맨 앞에 있는값이 후순위
		맨 뒤에 있는값이 앞 순위가 됨
		-->
	<select id="selectResPopuler" resultType="map">
		SELECT car_model, count(car_model) res_count
		FROM car_info c 
		JOIN res_info r ON c.car_idx = r.car_idx 
		GROUP BY car_model
		ORDER BY res_count 
		<if test="desc != null">
		DESC
		</if>
	</select>
</mapper>
